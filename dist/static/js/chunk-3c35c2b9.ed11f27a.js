(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c35c2b9"],{"386d":function(t,e,a){"use strict";var n=a("cb7c"),l=a("83a1"),i=a("5f1b");a("214f")("search",1,function(t,e,a,o){return[function(a){var n=t(this),l=void 0==a?void 0:a[e];return void 0!==l?l.call(a,n):new RegExp(a)[e](String(n))},function(t){var e=o(a,t,this);if(e.done)return e.value;var r=n(t),s=String(this),c=r.lastIndex;l(c,0)||(r.lastIndex=0);var u=i(r,s);return l(r.lastIndex,c)||(r.lastIndex=c),null===u?-1:u.index}]})},"43cc":function(t,e,a){"use strict";var n=a("f5ec"),l=a.n(n);l.a},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},c537:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container app-balance-check-list"},[a("div",{staticClass:"app-search-left dib-wrap"},[a("el-input",{staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"单位编号"},model:{value:t.dwbh,callback:function(e){t.dwbh=e},expression:"dwbh"}}),t._v(" "),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"单位ID",readonly:!0},model:{value:t.dwid,callback:function(e){t.dwid=e},expression:"dwid"}}),t._v(" "),a("el-input",{staticStyle:{width:"600px"},attrs:{size:"small",placeholder:"单位名称",readonly:!0},model:{value:t.dwmch,callback:function(e){t.dwmch=e},expression:"dwmch"}}),t._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-search",type:"primary"},on:{click:t.query}},[t._v("刷新")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.BalDataLoading,expression:"BalDataLoading"}],ref:"refTable",attrs:{data:t.BalData,height:"300px",stripe:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"Sid",label:"账户","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"User_info_sid",label:"客户","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Supply_sid",label:"ID","min-width":"40",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Supply_name",label:"组织","min-width":"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Club",label:"ID","min-width":"40",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"Club_name",label:"部门","min-width":"100",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"Type",label:"ID","min-width":"40",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Type_name",label:"类型","min-width":"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Sepecal_sid",label:"ID","min-width":"40",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Special_name",label:"活动","min-width":"130",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Balance",label:"B2B余额","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Grant_balance",label:"B2B授信","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Amount",label:"B2B冻结","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"K3_end",label:"K3余额","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"K3_grant_balance",label:"K3授信","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"K3_uncheck",label:"K3未审订单","min-width":"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"B2b_unpush",label:"B2B未推订单","min-width":"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Diff",label:"差异","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.getdetail(e.row)}}},[t._v("明细")]),t._v(" "),a("el-dropdown",{on:{command:t.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[a("el-button",{attrs:{type:"text"}},[t._v("更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:{row:e.row,id:1}}},[t._v("余额调整")]),t._v(" "),a("el-dropdown-item",{attrs:{command:{row:e.row,id:2}}},[t._v("检查冻结")]),t._v(" "),a("el-dropdown-item",{attrs:{command:{row:e.row,id:3}}},[t._v("临时授信")]),t._v(" "),a("el-dropdown-item",{attrs:{command:{row:e.row,id:4}}},[t._v("新增账户")])],1)],1)]}}])})],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.DetailDataLoading,expression:"DetailDataLoading"}],ref:"refDetail",attrs:{data:t.DetailData,height:"450px",stripe:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"user_account_sid",label:"账户","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sid",label:"流水号","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"发生时间","min-width":"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t.formatTime(e.row.create_time))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"change_type",label:"类型","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"change_amount",label:"发生金额","min-width":"80",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"end_amt",label:"余额","min-width":"80",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"is_show",label:"显示","min-width":"60",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"order_code",label:"单据编号","min-width":"120",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"club",label:"部门","min-width":"40",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"supply_sid",label:"组织","min-width":"40",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注","min-width":"320",align:"center"}})],1),t._v(" "),a("el-dialog",{attrs:{title:"临时授信",visible:t.grantVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.grantVisible=e}}},[t._v("\n        授信金额"),a("el-input",{attrs:{type:"number"},model:{value:t.grantAmount,callback:function(e){t.grantAmount=e},expression:"grantAmount"}}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.grantVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleGrant()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"余额调整",visible:t.adjustVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.adjustVisible=e}}},[t._v("\n        调整原因"),a("el-input",{model:{value:t.adjustNotes,callback:function(e){t.adjustNotes=e},expression:"adjustNotes"}}),t._v("\n        单据编号"),a("el-input",{model:{value:t.adjustBillno,callback:function(e){t.adjustBillno=e},expression:"adjustBillno"}}),t._v("\n        调整金额"),a("el-input",{attrs:{type:"number"},model:{value:t.adjustAmount,callback:function(e){t.adjustAmount=e},expression:"adjustAmount"}}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.adjustVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleAdjust()}}},[t._v("确 定")])],1)],1)],1)},l=[],i=(a("a481"),a("386d"),a("7f7f"),a("db72")),o=a("b775"),r=a("700d");function s(t){return Object(o["a"])({baseURL:r["a"],url:"/b2b/member/custBal",method:"get",params:t})}function c(t){return Object(o["a"])({baseURL:r["a"],url:"/b2b/member/custBalDetail",method:"get",params:t})}function u(t){return Object(o["a"])({baseURL:r["a"],url:"/b2b/member/addCustAccount",method:"get",params:t})}function d(t){return Object(o["a"])({baseURL:r["a"],url:"/b2b/member/custAccountGrant",method:"get",params:t})}function m(t){return Object(o["a"])({baseURL:r["a"],url:"/b2b/member/custAccountAdjust",method:"get",params:t})}function b(t){return Object(o["a"])({baseURL:r["a"],url:"/b2b/member/getCustAccountFreeze",method:"get",params:t})}function p(t){return Object(o["a"])({baseURL:r["a"],url:"/b2b/member/adjustCustAccountFreeze",method:"get",params:t})}var h=a("5880"),w={name:"PageB2bBalanceList",components:{},data:function(){return{dwbh:"DWI00021433",dwid:"",dwmch:"",BalData:[],DetailData:[],BalDataLoading:!1,DetailDataLoading:!1,grantVisible:!1,grantAmount:0,curRow:null,adjustVisible:!1,adjustNotes:"",adjustBillno:"",adjustAmount:0}},computed:Object(i["a"])({},Object(h["mapGetters"])(["permissions"]),{height:function(){return this.$store.getters.winHeight-165}}),activated:function(){this.$refs["refTable"].doLayout()},created:function(){},methods:{query:function(){var t=this;this.BalDataLoading=!0;var e={dwbh:this.dwbh};s(e).then(function(e){t.dwid=e.data.data.sid||"",t.dwmch=e.data.data.name||"",t.BalData=e.data.data.bal||[],t.DetailData=[],t.BalDataLoading=!1}).catch(function(){t.BalDataLoading=!1})},getdetail:function(t){var e=this;this.$refs["refTable"].setCurrentRow(t);var a={account_sid:t.Sid};this.DetailDataLoading=!0,c(a).then(function(t){e.DetailData=t.data.data||[],e.DetailDataLoading=!1}).catch(function(){e.DetailDataLoading=!1})},sizeChange:function(t){this.$refs["refSearch"].search({size:t})},pageChange:function(t){this.$refs["refSearch"].search({current:t})},formatTime:function(t){return t.substring(0,16).replace("T"," ")},handleCommand:function(t){var e=this;switch(this.$refs["refTable"].setCurrentRow(t.row),t.id){case 1:this.curRow=t.row,this.adjustNotes="",this.adjustBillno="",this.adjustAmount=-t.row.Diff,this.adjustVisible=!0;break;case 2:this.curRow=t.row,b(this.curRow).then(function(t){console.log(t.data.data),console.log(e.curRow.Amount),t.data.data!=e.curRow.Amount?e.$confirm("冻结金额从"+e.curRow.Amount+"调整为"+t.data.data+"吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.curRow.Amount=t.data.data,p(e.curRow).then(function(t){0==t.data.code?(e.query(),e.$message("冻结金额调整完成")):e.$message(t.data.msg)})}).catch(function(){}):e.$message("冻结金额没有差异")});break;case 3:if(0!=t.row.Type)return void this.$message("不是普通余额账户不能临时授信");this.curRow=t.row,this.grantAmount=0,this.grantVisible=!0;break;case 4:u(t.row).then(function(t){console.log(t),0==t.code?e.$notify({title:"新增账户",message:"新增账户成功",type:"sucess",duration:2e3}):e.$notify({title:"新增账户",message:"新增账户失败",type:"warning",duration:2e3})}).catch(function(t){});break}},handleGrant:function(){var t=this;this.grantVisible=!1,this.curRow.Diff=this.grantAmount,d(this.curRow).then(function(e){0==e.data.code?(t.query(),t.$notify({title:"临时授信",message:"临时授信成功",type:"success",duration:2e3})):t.$notify({title:"临时授信",message:"临时授信失败",type:"warning",duration:2e3})}).catch(function(t){})},handleAdjust:function(){var t=this;this.adjustVisible=!1,this.curRow.Diff=this.adjustAmount,this.curRow.Type_name=this.adjustNotes,this.curRow.Special_name=this.adjustBillno,m(this.curRow).then(function(e){0==e.data.code?(t.query(),t.$notify({title:"余额调整",message:"余额调整成功",type:"success",duration:2e3})):t.$notify({title:"余额调整",message:"余额调整失败",type:"warning",duration:2e3})}).catch(function(t){})}}},f=w,g=(a("43cc"),a("2877")),v=Object(g["a"])(f,n,l,!1,null,null,null);e["default"]=v.exports},f5ec:function(t,e,a){}}]);
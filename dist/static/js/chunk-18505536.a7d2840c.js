(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18505536"],{"0f9e":function(e,t,a){},"117c":function(e,t,a){},"121f":function(e,t,a){"use strict";var r=a("0f9e"),n=a.n(r);n.a},"386d":function(e,t,a){"use strict";var r=a("cb7c"),n=a("83a1"),i=a("5f1b");a("214f")("search",1,function(e,t,a,o){return[function(a){var r=e(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,r):new RegExp(a)[t](String(r))},function(e){var t=o(a,e,this);if(t.done)return t.value;var c=r(e),s=String(this),l=c.lastIndex;n(l,0)||(c.lastIndex=0);var u=i(c,s);return n(c.lastIndex,l)||(c.lastIndex=l),null===u?-1:u.index}]})},4704:function(e,t,a){"use strict";var r=a("117c"),n=a.n(r);n.a},"74f0":function(e,t,a){var r={"./en-gb":"39a6","./zh-cn":"5c3a"};function n(e){var t=i(e);return a(t)}function i(e){var t=r[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}n.keys=function(){return Object.keys(r)},n.resolve=i,e.exports=n,n.id="74f0"},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},b1a4:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container app-product-presale"},[a("search-bar",{ref:"refSearch",attrs:{"search-data":e.searchData,"auto-load":!0},on:{search:e.query}},[a("template",{slot:"right"},[a("div",{staticClass:"app-search-right"},[a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:e.create}},[e._v("添加")])],1)])],2),e._v(" "),a("div",{staticClass:"app-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tableData,height:e.height,stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mainImg",label:"商品图片","min-width":"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{directives:[{name:"viewer",rawName:"v-viewer"}],attrs:{src:e.ossURL+t.row.mainImg,fit:"contain"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"commodityName",label:"商品名称","min-width":"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"supplier",label:"供应商","min-width":"120",align:"center","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"所属俱乐部","min-width":"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.clubs,function(t){return a("span",{key:t,staticClass:"club-tag"},[e._v(e._s(1===t?"乐赛仙":2===t?"佐安堂":"初心"))])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"manufacturer",label:"商品所属厂家","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"publishTime",label:"预计上新日期","min-width":"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"预计上新价格","min-width":"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"280",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.update(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.remove(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"app-pagination"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","prev-text":"上一页","next-text":"下一页","page-sizes":[20,50,100,200],"current-page":e.page.currentPage,"page-size":e.page.pageSize,total:e.page.total},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1),e._v(" "),a("win-presale",{ref:"refPresale",attrs:{"supplier-list":e.supplierList}})],1)},n=[],i=(a("386d"),a("db72")),o=a("b775"),c=a("700d");function s(e){return Object(o["a"])({baseURL:c["a"],url:"/product/admin/product/notice/page",method:"get",params:e})}function l(e){return Object(o["a"])({baseURL:c["a"],url:"/product/admin/product/notice",method:"post",data:e})}function u(e){return Object(o["a"])({baseURL:c["a"],url:"/product/admin/product/notice/".concat(e.sid),method:"delete"})}function d(e){return Object(o["a"])({baseURL:c["a"],url:"/product/admin/product/notice",method:"put",data:e})}var f=a("2f62"),p=a("b932"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"el-win-product-presale",attrs:{title:e.edit?"编 辑":"新 增",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,size:"medium","label-width":"110px"}},[a("el-form-item",{attrs:{prop:"commodityName",label:"商品名称"}},[a("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.form.commodityName,callback:function(t){e.$set(e.form,"commodityName",t)},expression:"form.commodityName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"spec",label:"规格"}},[a("el-input",{attrs:{placeholder:"请输入规格"},model:{value:e.form.spec,callback:function(t){e.$set(e.form,"spec",t)},expression:"form.spec"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"manufacturer",label:"厂家"}},[a("el-input",{attrs:{placeholder:"请输入厂家"},model:{value:e.form.manufacturer,callback:function(t){e.$set(e.form,"manufacturer",t)},expression:"form.manufacturer"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"publishTime",label:"预计到货时间"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择预计到货时间"},model:{value:e.form.publishTime,callback:function(t){e.$set(e.form,"publishTime",t)},expression:"form.publishTime"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"price",label:"预计上新价格"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入预计上新价格"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"supplierSid",label:"选择供应商"}},[a("el-select",{model:{value:e.form.supplierSid,callback:function(t){e.$set(e.form,"supplierSid",t)},expression:"form.supplierSid"}},e._l(e.supplierList,function(e){return a("el-option",{key:e.sid,attrs:{label:e.name,value:e.sid}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{prop:"clubs",label:"俱乐部"}},[a("el-checkbox-group",{model:{value:e.form.clubs,callback:function(t){e.$set(e.form,"clubs",t)},expression:"form.clubs"}},[a("el-checkbox",{attrs:{label:1,name:"clubs"}},[e._v("乐赛仙")]),e._v(" "),a("el-checkbox",{attrs:{label:2,name:"clubs"}},[e._v("佐安堂")]),e._v(" "),a("el-checkbox",{attrs:{label:3,name:"clubs"}},[e._v("初心")])],1)],1),e._v(" "),a("el-form-item",{attrs:{prop:"areaList",label:"销售区域"}},[a("el-button",{on:{click:e.setArea}},[e._v("设置控销区域")])],1),e._v(" "),a("el-form-item",{attrs:{prop:"mainImg",label:"商品图片"}},[a("image-upload",{attrs:{multiple:!1},scopedSlots:e._u([{key:"tips",fn:function(){return[a("p",{staticClass:"tips-word"},[e._v("点击上传")])]},proxy:!0}]),model:{value:e.form.mainImg,callback:function(t){e.$set(e.form,"mainImg",t)},expression:"form.mainImg"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"content",label:"商品描述"}},[a("tinymce",{ref:"tinymce",attrs:{id:"tinymce",height:300},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.show=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("确 定")])],1),e._v(" "),a("win-area",{ref:"refArea"})],1)},b=[],h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"el-win-product-presale-area",attrs:{title:"设置控销区域(勾选的区域为不可销区域)",visible:e.show,"close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.show=t}}},[a("div",{staticClass:"app-table"},[e.clubs.length>1?[a("el-tabs",{attrs:{stretch:"","before-leave":e.handleBeforeLeave},on:{"tab-click":e.handleTabClick},model:{value:e.activeClub,callback:function(t){e.activeClub=t},expression:"activeClub"}},e._l(e.clubs,function(e){return a("el-tab-pane",{key:e,attrs:{label:1===e?"乐赛仙":2===e?"佐安堂":"初心",name:e.toString()}})}),1)]:e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"table",attrs:{data:e.tableData,height:450},on:{"selection-change":e.handleSelect}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"省区名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"areaCode",label:"省区编号",align:"center"}})],1)],2),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.show=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("确 定")])],1)])},g=[],v=(a("7f7f"),a("6b54"),a("ac6a"),a("feb7")),_={name:"WinProductPresaleArea",components:{},data:function(){return{edit:!1,loading:!1,tableData:[],tableLoading:!1,activeClub:0,clubs:[],selectedData:[],selection:[],show:!1}},methods:{handleTabClick:function(){var e=this;this.$nextTick(function(){e.toggleRowSelection()})},handleBeforeLeave:function(e,t){var a=this;return this.selectedData.forEach(function(e){e.club.toString()===t&&(e.areaMapList=[],a.selection.forEach(function(t){e.areaMapList.push({areaSid:t.id,areaNode:t.node,areaName:t.name})}))}),this.selection=[],!0},update:function(e,t){var a=this;this.edit=!0,this.loading=!1,this.callback=t,this.activeClub=e.clubs[0].toString(),this.clubs=e.clubs,this.selectedData=[],this.show=!0,this.$nextTick(function(){a.query(function(){a.setProductArea(e)})})},save:function(){var e=this;this.selectedData.forEach(function(t){t.club.toString()===e.activeClub&&(t.areaMapList=[],e.selection.forEach(function(e){t.areaMapList.push({areaSid:e.id,areaNode:e.node,areaName:e.name})}))}),this.callback(this.selectedData)},close:function(){this.show=!1},handleSelect:function(e){this.selection=e},query:function(e){var t=this;this.tableLoading=!0,0===this.tableData.length?Object(v["b"])({node:1}).then(function(a){t.tableData=a.data.data||[],t.tableLoading=!1,e()}):e()},setProductArea:function(e){var t=this,a=e.areaList||[];this.clubs.forEach(function(e){var r=a.filter(function(t){return t.club===e});t.selectedData.push({club:e,areaMapList:1===r.length?r[0].areaMapList:[]})}),this.tableLoading=!1,this.$nextTick(function(){t.toggleRowSelection()})},toggleRowSelection:function(){var e=this;1===this.selectedData.filter(function(t){return t.club.toString()===e.activeClub}).length&&this.selectedData.forEach(function(t){t.club.toString()===e.activeClub&&e.tableData.forEach(function(a){var r=t.areaMapList.filter(function(e){return a.id===e.areaSid});1===r.length?e.$refs["table"].toggleRowSelection(a,!0):e.$refs["table"].toggleRowSelection(a,!1)})})}}},L=_,w=(a("4704"),a("2877")),y=Object(w["a"])(L,h,g,!1,null,null,null),k=y.exports,x=a("4a9d"),$=a("8256"),S=a("c1df"),O=a.n(S),j={name:"WinPresale",components:{imageUpload:x["a"],Tinymce:$["a"],WinArea:k},props:{supplierList:{type:Array,default:function(){return[]}}},data:function(){return{edit:!1,loading:!1,form:{commodityName:"",spec:"",manufacturer:"",publishTime:"",supplierSid:"",price:"",clubs:[],areaList:[],mainImg:"",content:""},rules:{commodityName:[{required:!0,message:"请输入商品名称",trigger:"blur"}],spec:[{required:!0,message:"请输入规格",trigger:"blur"}],manufacturer:[{required:!0,message:"请输入厂家",trigger:"blur"}],publishTime:[{required:!0,message:"请选择预计到货时间",trigger:"blur"}],supplierSid:[{required:!0,message:"请选择供应商",trigger:"blur"}],price:[],clubs:[{type:"array",required:!0,message:"请选择展示范围",trigger:"change"}],areaList:[],mainImg:[{required:!0,message:"请上传商品图片",trigger:"change"}],content:[]},show:!1}},watch:{},created:function(){},methods:{add:function(e){var t=this;this.edit=!1,this.loading=!1,this.callback=e,this.show=!0,this.$nextTick(function(){t.$refs["ruleForm"].resetFields(),t.$refs["tinymce"].setContent(""),t.form.mainImg=""})},update:function(e,t){var a=this;this.edit=!0,this.loading=!1,this.callback=t,this.show=!0,this.item=e,this.$nextTick(function(){for(var t in a.$refs["ruleForm"].resetFields(),a.form)a.form[t]=e[t];a.form.sid=e.sid,a.$refs["tinymce"].setContent(e.content)})},save:function(){var e=this;this.$refs["ruleForm"].validate(function(t){if(!t)return!1;e.loading=!0;var a=Object.assign({},e.form);a.publishTime=O()(a.publishTime).format("YYYY-MM-DD HH:mm:ss"),e.callback(a)})},close:function(){this.show=!1},setArea:function(){var e=this;this.form.clubs.length>0?this.$refs["refArea"].update(Object.assign(this.form),function(t){e.form.areaList=t,e.$refs["refArea"].close()}):this.$message({message:"请先选择俱乐部",type:"error"})}}},C=j,R=(a("121f"),Object(w["a"])(C,m,b,!1,null,null,null)),U=R.exports,D={name:"PageProductPresale",components:{searchBar:p["a"],WinPresale:U},data:function(){return{ossURL:this.$store.getters.oss_url+"/",searchData:{quickList:[{label:"按商品名称",value:"commodityName"},{label:"按生产厂家",value:"manufacturer"}],searchList:[],page:{size:20,current:1}},tableData:[],supplierList:[],page:{total:0},tableLoading:!1}},computed:Object(i["a"])({},Object(f["b"])(["permissions"]),{height:function(){return this.$store.getters.winHeight-205}}),methods:{query:function(e){var t=this;this.tableLoading=!0,s(Object.assign({},e)).then(function(e){t.tableData=e.data.data.records||[],t.supplierList=e.data.data.supplierList||[],t.page.total=e.data.data.total,t.tableLoading=!1})},sizeChange:function(e){this.$refs["refSearch"].search({size:e})},pageChange:function(e){this.$refs["refSearch"].search({current:e})},create:function(){var e=this;this.$refs["refPresale"].add(function(t){l(t).then(function(){e.$refs["refPresale"].loading=!1,e.$refs["refPresale"].close(),e.$refs["refSearch"].search(),e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})}).catch(function(){e.$refs["refPresale"].loading=!1})})},remove:function(e){var t=this;this.$confirm('是否确认删除名称为"'+e.commodityName+'"的数据吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return u(e)}).then(function(){t.$refs["refSearch"].search(),t.$message({showClose:!0,message:"删除成功",type:"success"})}).catch(function(){})},update:function(e){var t=this;this.$refs["refPresale"].update(e,function(e){d(e).then(function(){t.$refs["refSearch"].search(),t.$refs["refPresale"].loading=!1,t.$refs["refPresale"].close(),t.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})}).catch(function(){t.$refs["refPresale"].loading=!1})})}}},P=D,T=(a("bbc9"),Object(w["a"])(P,r,n,!1,null,"58e1e540",null));t["default"]=T.exports},bbc9:function(e,t,a){"use strict";var r=a("e830"),n=a.n(r);n.a},e830:function(e,t,a){},feb7:function(e,t,a){"use strict";a.d(t,"c",function(){return i}),a.d(t,"i",function(){return o}),a.d(t,"f",function(){return c}),a.d(t,"n",function(){return s}),a.d(t,"b",function(){return l}),a.d(t,"d",function(){return u}),a.d(t,"k",function(){return d}),a.d(t,"p",function(){return f}),a.d(t,"o",function(){return p}),a.d(t,"m",function(){return m}),a.d(t,"l",function(){return b}),a.d(t,"q",function(){return h}),a.d(t,"g",function(){return g}),a.d(t,"e",function(){return v}),a.d(t,"h",function(){return _}),a.d(t,"r",function(){return L}),a.d(t,"j",function(){return w}),a.d(t,"a",function(){return y});var r=a("b775"),n=a("700d");function i(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/page",method:"get",params:e})}function o(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/relation/list/".concat(e.productSid),method:"get",params:e})}function c(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/relation/productList/page",method:"get",params:e})}function s(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/relation",method:"put",data:e})}function l(e){return Object(r["a"])({baseURL:n["a"],url:"/admin/external/area/treeInfo",method:"get",params:e})}function u(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/area/".concat(e.sid),method:"get",params:e})}function d(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/".concat(e.sid,"/area"),method:"put",data:e.area})}function f(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/saleStatus",method:"put",data:e})}function p(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/risePrice/".concat(e.sid),method:"put",data:e.prices})}function m(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/price/audit",method:"POST",data:e})}function b(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/showIndex/".concat(e.sid),method:"put",data:e.index})}function h(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/label/relation",method:"post",data:e})}function g(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/sku/list/".concat(e.sid),method:"get",params:e})}function v(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/info/".concat(e.sid),method:"get",params:e})}function _(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/label/page",method:"get",params:e})}function L(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/headSales",method:"post",data:e})}function w(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/inspectionReport/batchUpload/".concat(e.sid),method:"post",data:e.report})}function y(e){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/product/createIndexBySid/".concat(e.sid),method:"get",params:e})}}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-481da8ea"],{"074a":function(e,t,a){"use strict";var r=a("d33b"),n=a.n(r);n.a},"386d":function(e,t,a){"use strict";var r=a("cb7c"),n=a("83a1"),o=a("5f1b");a("214f")("search",1,function(e,t,a,i){return[function(a){var r=e(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,r):new RegExp(a)[t](String(r))},function(e){var t=i(a,e,this);if(t.done)return t.value;var s=r(e),l=String(this),c=s.lastIndex;n(c,0)||(s.lastIndex=0);var d=o(s,l);return n(s.lastIndex,c)||(s.lastIndex=c),null===d?-1:d.index}]})},"6af2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container app-order-list"},[a("search-bar",{ref:"refSearch",attrs:{"search-data":e.searchData,"auto-load":!0},on:{reset:e.reset,search:e.query}},[a("template",{slot:"left"},[a("div",{staticClass:"search-item dib"},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small"},on:{change:e.search},model:{value:e.dateTime,callback:function(t){e.dateTime=t},expression:"dateTime"}})],1)])],2),e._v(" "),a("div",{staticClass:"app-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"refTable",attrs:{data:e.tableData,height:e.height,stripe:""}},[a("el-table-column",{attrs:{prop:"orderId",label:"订单编号","min-width":"180",align:"center",fixed:"","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"link",on:{click:function(a){return e.detail(t.row)}}},[e._v(e._s(t.row.orderId))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"businessName",label:"单位名称","min-width":"150",align:"center","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"supplierDesc",label:"供应商","min-width":"120",align:"center","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"clubDesc",label:"所属俱乐部","min-width":"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobilePhone",label:"会员手机号码","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"shipAddress",label:"收件地址","min-width":"150",align:"center","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalAmount",label:"订单金额","min-width":"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderType",label:"订单类型","min-width":"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.orderType?a("span",[e._v("自主下单")]):a("span",[e._v("代下单")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"orderStatusDesc",label:"订单状态","min-width":"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderType",label:"是否推金蝶","min-width":"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[!0===t.row.k3cloudSave?a("span",[e._v("已推")]):a("span",[e._v("未推")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"paymentTypeDesc",label:"支付方式","min-width":"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"paymentTime",label:"支付时间","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"shippingName",label:"配送方式","min-width":"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"invoiceTypeDesc",label:"发票信息","min-width":"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userMessage",label:"订单备注","min-width":"120",align:"center","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"180",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[a("el-button",{attrs:{type:"text"}},[e._v("更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:{row:t.row,id:1}}},[e._v("更新索引")]),e._v(" "),a("el-dropdown-item",{directives:[{name:"loading",rawName:"v-loading",value:t.row.pushKingLoading,expression:"scope.row.pushKingLoading"}],attrs:{disabled:2!==t.row.orderStatus,command:{row:t.row,id:2}}},[e._v("推送金蝶")]),e._v(" "),a("el-dropdown-item",{directives:[{name:"loading",rawName:"v-loading",value:t.row.pushReceiptLoading,expression:"scope.row.pushReceiptLoading"}],attrs:{command:{row:t.row,id:3}}},[e._v("推送收款单")]),e._v(" "),a("el-dropdown-item",{attrs:{command:{row:t.row,id:4}}},[e._v("导出订单")]),e._v(" "),a("el-dropdown-item",{attrs:{command:{row:t.row,id:5},disabled:1!==t.row.orderStatus}},[e._v("取消订单")])],1)],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"app-pagination"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","prev-text":"上一页","next-text":"下一页","page-sizes":[20,50,100,200],"current-page":e.searchData.page.current,"page-size":e.searchData.page.size,total:e.page.total},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1)],1)},n=[],o=(a("386d"),a("db72")),i=a("b775"),s=a("700d");function l(e){return Object(i["a"])({baseURL:s["a"],url:"/order/admin/order/page",method:"get",params:e})}function c(e){return Object(i["a"])({baseURL:s["a"],url:"/order/admin/order/updateEsOrder",method:"get",params:e})}function d(e){return Object(i["a"])({baseURL:s["a"],url:"/order/api/k3cloud/order/".concat(e.orderId),method:"post",timeout:6e4})}function u(e){return Object(i["a"])({baseURL:s["a"],url:"/order/api/k3cloud/receiveBill",method:"post",timeout:6e4,data:[e.orderId]})}function p(e){return Object(i["a"])({baseURL:s["a"],url:"/order/admin/order/exportOrderDetail/".concat(e.orderId),method:"get",responseType:"blob"})}function h(e){return Object(i["a"])({baseURL:s["a"],url:"/order/api/order/".concat(e.orderId,"/").concat(e.orderStatus),method:"PUT",data:e})}var m=a("2f62"),f=a("b932"),b=a("c1df"),g=a.n(b),v={name:"PageOrderList",components:{searchBar:f["a"]},data:function(){return{ossURL:this.$store.getters.oss_url+"/",searchData:{quickList:[{label:"订单编号",value:"orderId"},{label:"单位名称",value:"businessName"},{label:"会员电话",value:"mobilePhone"},{label:"省总姓名",value:"provinceManagerName"},{label:"地总姓名",value:"regionManagerName"},{label:"商务专员",value:"salesExecutiveName"}],searchList:[{prop:"orderStatus",placeholder:"订单状态",type:"select",clearable:!0,list:[{label:"待付款",value:1},{label:"待发货",value:2},{label:"已发货",value:3},{label:"已收货",value:4},{label:"已完成",value:5},{label:"已取消",value:6},{label:"退款中",value:7}]},{prop:"orderType",placeholder:"订单类型",type:"select",clearable:!0,list:[{label:"自主下单",value:1},{label:"代下单",value:2}]}],page:{size:20,current:1}},dateTime:[],tableData:[],tableLoading:!1,page:{total:0}}},computed:Object(o["a"])({},Object(m["b"])(["permissions"]),{height:function(){return this.$store.getters.winHeight-205}}),methods:{handleCommand:function(e){switch(this.$refs["refTable"].setCurrentRow(e.row),e.id){case 1:this.refreshIndex(e.row);break;case 2:this.pushKingDom(e.row);break;case 3:this.pushReceipt(e.row);break;case 4:this.exportExecl(e.row);break;case 5:this.cancel(e.row);break}},query:function(e){var t=this;this.tableLoading=!0,this.dateTime&&2===this.dateTime.length&&(e.startTime=g()(this.dateTime[0]).format("YYYY-MM-DD"),e.endTime=g()(this.dateTime[1]).format("YYYY-MM-DD")),l(Object.assign({},e)).then(function(e){t.tableData=e.data.data.records,t.page.total=e.data.data.total,t.tableLoading=!1})},search:function(){this.$refs["refSearch"].search()},reset:function(){this.dateTime=[]},sizeChange:function(e){this.$refs["refSearch"].search({size:e})},pageChange:function(e){this.$refs["refSearch"].search({current:e})},detail:function(e){this.$router.push({path:"/order/detail",query:{id:e.orderId}})},refreshIndex:function(e){var t=this;this.$confirm('是否确认更新订单号为"'+e.orderId+'"的索引吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return c({orderId:e.orderId})}).then(function(){t.$refs["refSearch"].search(),t.$message({showClose:!0,message:"更新成功",type:"success"})}).catch(function(){})},pushKingDom:function(e){var t=this;this.$confirm('是否确认将订单号为"'+e.orderId+'"的订单推送至金碟?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return t.$set(e,"pushKingLoading",!0),d({orderId:e.orderId})}).then(function(){t.$set(e,"pushKingLoading",!1),t.$refs["refSearch"].search(),t.$message({showClose:!0,message:"推送成功",type:"success"})}).catch(function(){t.$set(e,"pushKingLoading",!1)})},pushReceipt:function(e){var t=this;this.$confirm('是否确认将订单号"'+e.orderId+'"推送收款单吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return t.$set(e,"pushReceiptLoading",!0),u({orderId:e.orderId})}).then(function(){t.$set(e,"pushReceiptLoading",!1),t.$refs["refSearch"].search(),t.$message({showClose:!0,message:"推送成功",type:"success"})}).catch(function(){t.$set(e,"pushReceiptLoading",!1)})},exportExecl:function(e){p(e).then(function(t){var a=new Blob([t.data],{type:"application/vnd.ms-excel;charset=utf-8"}),r=window.URL.createObjectURL(a),n=document.createElement("a");n.download=e.orderId+".xls",n.href=r,n.click()})},cancel:function(e){var t=this;this.$confirm('是否要取消订单号为"'+e.orderId+'"的订单吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return h({orderId:e.orderId,orderStatus:6})}).then(function(){t.$refs["refSearch"].search(),t.$message({showClose:!0,message:"取消成功",type:"success"})}).catch(function(){})}}},w=v,_=(a("074a"),a("2877")),x=Object(_["a"])(w,r,n,!1,null,null,null);t["default"]=x.exports},"74f0":function(e,t,a){var r={"./en-gb":"39a6","./zh-cn":"5c3a"};function n(e){var t=o(e);return a(t)}function o(e){var t=r[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}n.keys=function(){return Object.keys(r)},n.resolve=o,e.exports=n,n.id="74f0"},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},d33b:function(e,t,a){}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05729509"],{"34b6":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container app-other-banner",attrs:{id:"supplierList"}},[a("search-bar",{ref:"refSearch",attrs:{"search-data":e.searchData,"auto-load":!0},on:{search:e.queryList}},[a("template",{slot:"right"},[a("div",{staticClass:"app-search-right"},[a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary"},on:{click:e.create}},[e._v("添加")])],1)])],2),e._v(" "),a("div",{staticClass:"app-table"},[a("el-table",{attrs:{loading:e.tableLoading,data:e.tableData,height:e.height,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"供应商名称",align:"center",width:"260","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"公司地址",align:"center",width:"260","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"contactor",label:"联系人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"contactorPhone",label:"联系电话",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bankName",label:"开户行",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bankCode",label:"银行卡号",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"erpCode",label:"组织ID",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(0===t.row.status?"启用":"禁用"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"280",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.update(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.deleteSupplier(t.row)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.setId(t.row)}}},[e._v("设置ID")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.stopSupplier(t.row)}}},[e._v(e._s(0===t.row.status?"禁用":"启用"))]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.seeRegion(t.row)}}},[e._v("设置区域")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"app-pagination"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","prev-text":"上一页","next-text":"下一页","page-sizes":[20,50,100,200],"current-page":e.searchData.page.current,"page-size":e.searchData.page.size,total:e.page.total},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1),e._v(" "),a("add-supplier",{ref:"addSupplier"}),e._v(" "),a("el-dialog",{attrs:{"custom-class":"set-erp-code",title:"设置ID",width:"360px",visible:e.showSetId,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showSetId=t},close:e.initData}},[a("p",{staticClass:"top-none"},[e._v("组织ID")]),e._v(" "),a("el-input",{attrs:{size:"small"},model:{value:e.newCode,callback:function(t){e.newCode=t},expression:"newCode"}}),e._v(" "),a("p",{staticClass:"tips"},[e._v("注：ERP系统中的组织ID")]),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showSetId=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",disabled:!e.newCode.trim(),type:"primary"},on:{click:e.saveErpCode}},[e._v("保 存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{"custom-class":"set-region",title:"设置区域",width:"460px",visible:e.showSetRegion,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showSetRegion=t},close:e.initData}},[a("div",{staticClass:"all-region"},[a("el-tree",{ref:"myTree",attrs:{"default-checked-keys":[],"show-checkbox":"","node-key":"id",data:e.currentRegion,props:e.defaultProps,accordion:""}})],1),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showSetRegion=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveArea}},[e._v("保 存")])],1)])],1)},s=[],o=(a("386d"),a("ac6a"),a("7f7f"),a("b242"),a("e35b")),r=a("b932"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.edit?"编辑供应商":"新增供应商",width:"600px","custom-class":"add-suplier",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,size:"medium","label-width":"105px"}},[a("el-form-item",{attrs:{prop:"erpCode",label:"金蝶编号"}},[a("el-input",{attrs:{placeholder:"请输入供应商对应的金蝶系统编号"},model:{value:e.form.erpCode,callback:function(t){e.$set(e.form,"erpCode",t)},expression:"form.erpCode"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"name",label:"供应商名称"}},[a("el-input",{attrs:{placeholder:"请输入供应商名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"contactor",label:"联系人"}},[a("el-input",{attrs:{placeholder:"请输入供应商联系人"},model:{value:e.form.contactor,callback:function(t){e.$set(e.form,"contactor",t)},expression:"form.contactor"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"contactorPhone",label:"联系电话"}},[a("el-input",{attrs:{maxlength:"11",placeholder:"请输入供应商联系电话"},model:{value:e.form.contactorPhone,callback:function(t){e.$set(e.form,"contactorPhone",t)},expression:"form.contactorPhone"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"address",label:"地址"}},[a("el-input",{attrs:{placeholder:"请输入供应商地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"bankName",label:"开户行"}},[a("el-input",{attrs:{placeholder:"请输入供应商银行开户行"},model:{value:e.form.bankName,callback:function(t){e.$set(e.form,"bankName",t)},expression:"form.bankName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"bankCode",label:"银行卡号"}},[a("el-input",{attrs:{placeholder:"请输入供应商银行卡号"},model:{value:e.form.bankCode,callback:function(t){e.$set(e.form,"bankCode",t)},expression:"form.bankCode"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.show=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("保 存")])],1)],1)},l=[],c={name:"AddSupplier",components:{},data:function(){return{loading:!1,form:{erpCode:"",name:"",contactor:"",contactorPhone:"",address:"",bankName:"",bankCode:""},rules:{erpCode:[{required:!0,message:"请输入供应商对应的金蝶系统编号",trigger:"blur"}],name:[{required:!0,message:"请输入供应商名称",trigger:"blur"}],bankName:[{required:!0,message:"请输入供应商银行开户行",trigger:"blur"}],bankCode:[{required:!0,message:"请输入供应商银行卡号",trigger:"blur"},{max:16,message:"银行卡号不能超过16位",trigger:"blur"}]},show:!1,edit:!1}},watch:{},mounted:function(){},methods:{update:function(e,t){var a=this;this.edit=!0,this.loading=!1,this.callback=t,this.show=!0,this.$nextTick(function(){for(var t in a.$refs["ruleForm"].resetFields(),a.form)a.form[t]=e[t];a.form.sid=e.sid})},add:function(e){var t=this;this.edit=!1,this.loading=!1,this.callback=e,this.show=!0,this.$nextTick(function(){t.$refs["ruleForm"].resetFields()})},save:function(){var e=this;this.$refs["ruleForm"].validate(function(t){if(!t)return!1;e.loading=!0;var a=Object.assign({},e.form);e.callback(a)})},close:function(){this.show=!1}}},d=c,u=a("2877"),p=Object(u["a"])(d,i,l,!1,null,null,null),f=p.exports,h={components:{searchBar:r["a"],AddSupplier:f},data:function(){return{searchData:{quickList:[{label:"按供应商名称",value:"name"}],searchList:[],page:{size:20,current:1}},page:{total:0},searchParams:{},tableLoading:!1,ossURL:this.$store.getters.oss_url+"/",tableData:[],showSetId:!1,newCode:"",showSetRegion:!1,allRegion:[],currentRegion:[],defaultProps:{children:"areaList",label:"name",disabled:"disabled"},otherIds:[],sid:""}},computed:{height:function(){return this.$store.getters.winHeight-205}},mounted:function(){var e=this;Object(o["i"])().then(function(t){0===t.data.code&&(e.allRegion=t.data.data)})},methods:{initData:function(){this.newCode=""},queryList:function(e){var t=this;e&&(delete e.isTrusted,this.searchParams=Object.assign({},e)),this.tableLoading=!0,Object(o["g"])(this.searchParams).then(function(e){t.tableLoading=!1,0===e.data.code&&(t.tableData=e.data.data.records,t.page.total=e.data.data.total)}).catch(function(){t.tableLoading=!1})},create:function(){var e=this;this.$refs["addSupplier"].add(function(t){Object(o["f"])(t).then(function(t){e.$refs["addSupplier"].loading=!1,e.$refs["addSupplier"].close(),e.queryList(),e.$message({message:t.data.msg,type:"success",duration:2e3})}).catch(function(){e.$refs["addSupplier"].loading=!1})})},update:function(e){var t=this;this.$refs["addSupplier"].update(e,function(e){Object(o["c"])(e).then(function(e){t.$refs["addSupplier"].loading=!1,t.$refs["addSupplier"].close(),t.queryList(),t.$message({message:e.data.msg,type:"success",duration:2e3})}).catch(function(){t.$refs["addSupplier"].loading=!1})})},deleteSupplier:function(e){var t=this;this.$confirm("是否确认删除名称为【"+e.name+"】的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o["b"])({sid:e.sid}).then(function(e){0===e.data.code&&(t.queryList(),t.$message({showClose:!0,message:e.data.msg,type:"success"}))})}).catch(function(){})},setId:function(e){this.showSetId=!0,this.newCode=e.erpCode,this.sid=e.sid},saveErpCode:function(){var e=this;this.newCode.trim()&&Object(o["d"])({sid:this.sid,erpCode:this.newCode}).then(function(t){0===t.data.code&&(e.queryList(),e.showSetId=!1,e.$message({showClose:!0,message:t.data.msg,type:"success"}))})},stopSupplier:function(e){var t=this;this.$confirm("是否确认".concat(0===e.status?"禁用":"启用","名称为【").concat(e.name,"】的数据项?"),"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o["h"])({sid:e.sid,status:0===e.status?1:0}).then(function(e){0===e.data.code&&(t.queryList(),t.$message({showClose:!0,message:e.data.msg,type:"success"}))})}).catch(function(){})},getDisabled:function(e,t){var a=this;e.areaList.forEach(function(e){e.areaList?a.getDisabled(e,t):t.indexOf(e.id)>-1?e.disabled=!0:e.disabled=!1})},seeRegion:function(e){var t=this;this.sid=e.sid,this.currentRegion=this.allRegion;var a=[],n=[];Object(o["a"])(e.sid).then(function(e){0===e.data.code?(e.data.data.other.length&&(e.data.data.other.forEach(function(e){n.push(e.areaSid)}),t.currentRegion.forEach(function(e){e.areaList?t.getDisabled(e,n):n.indexOf(e.id)>-1?e.disabled=!0:e.disabled=!1})),t.showSetRegion=!0,t.$nextTick(function(){e.data.data.owner.forEach(function(e){a.push(e.areaSid)}),t.$refs.myTree.setCheckedKeys(a)})):t.showSetRegion=!0}).catch(function(){t.showSetRegion=!0})},saveArea:function(){var e=this,t=this.$refs.myTree.getCheckedKeys();Object(o["e"])({sidList:t,sid:this.sid}).then(function(t){0===t.data.code&&(e.$message({showClose:!0,message:t.data.msg,type:"success"}),e.showSetRegion=!1)})},sizeChange:function(e){this.$refs["refSearch"].search({size:e})},pageChange:function(e){this.$refs["refSearch"].search({current:e})}}},m=h,b=Object(u["a"])(m,n,s,!1,null,null,null);t["default"]=b.exports},"386d":function(e,t,a){"use strict";var n=a("cb7c"),s=a("83a1"),o=a("5f1b");a("214f")("search",1,function(e,t,a,r){return[function(a){var n=e(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,n):new RegExp(a)[t](String(n))},function(e){var t=r(a,e,this);if(t.done)return t.value;var i=n(e),l=String(this),c=i.lastIndex;s(c,0)||(i.lastIndex=0);var d=o(i,l);return s(i.lastIndex,c)||(i.lastIndex=c),null===d?-1:d.index}]})},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},b242:function(e,t,a){},e35b:function(e,t,a){"use strict";a.d(t,"f",function(){return o}),a.d(t,"g",function(){return r}),a.d(t,"b",function(){return i}),a.d(t,"d",function(){return l}),a.d(t,"h",function(){return c}),a.d(t,"c",function(){return d}),a.d(t,"a",function(){return u}),a.d(t,"i",function(){return p}),a.d(t,"e",function(){return f});var n=a("b775"),s=a("700d");function o(e){return Object(n["a"])({baseURL:s["a"],url:"/member/admin/supply",method:"post",headers:{"Content-Type":"application/json"},data:e})}function r(e){return Object(n["a"])({baseURL:s["a"],url:"/member/admin/supply",method:"get",params:e})}function i(e){return Object(n["a"])({baseURL:s["a"],url:"/member/admin/supply/".concat(e.sid),method:"delete"})}function l(e){return Object(n["a"])({baseURL:s["a"],url:"/member/admin/supply/erpCode?sid=".concat(e.sid,"&erpCode=").concat(e.erpCode),method:"put"})}function c(e){return Object(n["a"])({baseURL:s["a"],url:"/member/admin/supply/supplyStatus/".concat(e.sid,"/").concat(e.status),method:"put"})}function d(e){return Object(n["a"])({baseURL:s["a"],url:"/member/admin/supply/edit",method:"put",data:e})}function u(e){return Object(n["a"])({baseURL:s["a"],url:"/member/admin/supply/areaList/".concat(e),method:"get"})}function p(){return Object(n["a"])({baseURL:s["a"],url:"/admin/external/area/treeInfo",method:"get"})}function f(e){return Object(n["a"])({baseURL:s["a"],url:"/member/admin/supply/areaSids/".concat(e.sid),method:"put",headers:{"Content-Type":"application/json"},data:{areaSids:e.sidList}})}}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e16788e"],{"0d62":function(t,e,a){"use strict";e["a"]={typeData:[{label:"非关键属性",value:1},{label:"关键属性",value:2},{label:"搜索属性",value:3}],viewTypeData:[{label:"文本框",value:1},{label:"下拉框",value:2},{label:"单选",value:3},{label:"多选",value:4},{label:"文本域",value:5}]}},1953:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"a",function(){return l}),a.d(e,"b",function(){return s}),a.d(e,"d",function(){return o});var r=a("b775"),n=a("700d");function i(t){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/productAttr/page",method:"get",params:t})}function l(t){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/productAttr",method:"post",data:t})}function s(t){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/productAttr/".concat(t.sid),method:"delete"})}function o(t){return Object(r["a"])({baseURL:n["a"],url:"/product/admin/productAttr",method:"put",data:t})}},"386d":function(t,e,a){"use strict";var r=a("cb7c"),n=a("83a1"),i=a("5f1b");a("214f")("search",1,function(t,e,a,l){return[function(a){var r=t(this),n=void 0==a?void 0:a[e];return void 0!==n?n.call(a,r):new RegExp(a)[e](String(r))},function(t){var e=l(a,t,this);if(e.done)return e.value;var s=r(t),o=String(this),u=s.lastIndex;n(u,0)||(s.lastIndex=0);var c=i(s,o);return n(s.lastIndex,u)||(s.lastIndex=u),null===c?-1:c.index}]})},"7b1a":function(t,e,a){},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"9a47":function(t,e,a){"use strict";var r=a("7b1a"),n=a.n(r);n.a},f49d:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container app-product-attribute"},[a("search-bar",{ref:"refSearch",attrs:{"search-data":t.searchData,"auto-load":!0},on:{search:t.query}},[a("template",{slot:"right"},[a("div",{staticClass:"app-search-right"},[a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary"},on:{click:t.create}},[t._v("新增属性")])],1)])],2),t._v(" "),a("div",{staticClass:"app-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.tableData,height:t.height,stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"attrName",label:"属性键名","min-width":"150",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"属性类型","min-width":"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.typeData.filter(function(t){return t.value==e.row.type})[0].label)+"\n                ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"viewType",label:"控件类型","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.viewTypeData.filter(function(t){return t.value==e.row.viewType})[0].label)+"\n                ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"280",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.update(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.remove(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"app-pagination"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","prev-text":"上一页","next-text":"下一页","page-sizes":[20,50,100,200],"current-page":t.searchData.page.current,"page-size":t.searchData.page.size,total:t.page.total},on:{"size-change":t.sizeChange,"current-change":t.pageChange}})],1),t._v(" "),a("win-attribute",{ref:"refAttribute"})],1)},n=[],i=(a("386d"),a("db72")),l=a("1953"),s=a("5880"),o=a("b932"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"el-win-product-attribute",attrs:{title:t.edit?"编 辑":"新 增",visible:t.show,"close-on-click-modal":!1},on:{"update:visible":function(e){t.show=e}}},[a("el-form",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,size:"medium","label-width":"80px"}},[a("el-form-item",{attrs:{prop:"attrName",label:"属性名称"}},[a("el-input",{attrs:{placeholder:"请输入属性名称"},model:{value:t.form.attrName,callback:function(e){t.$set(t.form,"attrName",e)},expression:"form.attrName"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"type",label:"属性类型"}},[a("el-select",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.typeData,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{prop:"viewType",label:"控件类型"}},[a("el-select",{model:{value:t.form.viewType,callback:function(e){t.$set(t.form,"viewType",e)},expression:"form.viewType"}},t._l(t.viewTypeData,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{prop:"attrCode",label:"属性编码"}},[a("el-input",{attrs:{placeholder:"请输入属性编码"},model:{value:t.form.attrCode,callback:function(e){t.$set(t.form,"attrCode",e)},expression:"form.attrCode"}})],1),t._v(" "),1!==t.form.viewType&&5!==t.form.viewType?a("el-form-item",{attrs:{prop:"productAttrValueList",label:"属性值"}},[t._l(t.form.productAttrValueList,function(e,r){return a("el-tag",{key:r,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){return t.removeAttr(r)}}},[t._v("\n                "+t._s(e.attrValue)+"\n            ")])}),t._v(" "),t.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{effect:"plain",size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("添加属性值")])],2):t._e()],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.show=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.save}},[t._v("确 定")])],1)],1)},c=[],p=a("0d62"),f={name:"WinNews",components:{},data:function(){return{edit:!1,loading:!1,form:{attrName:"",type:"",viewType:"",attrCode:"",productAttrValueList:[]},rules:{attrName:[{required:!0,message:"请输入分类名称",trigger:"blur"}],type:[{required:!0,message:"请选择属性类型",trigger:"change"}],viewType:[{required:!0,message:"请选择控件类型",trigger:"change"}],attrCode:[{required:!0,message:"请输入属性编码",trigger:"blur"}],productAttrValueList:[{required:!0,type:"array",message:"请添加属性值",trigger:"blur"}]},typeData:p["a"].typeData,viewTypeData:p["a"].viewTypeData,inputValue:"",inputVisible:!1,show:!1}},watch:{},created:function(){},methods:{add:function(t){var e=this;this.edit=!1,this.loading=!1,this.callback=t,this.show=!0,this.$nextTick(function(){e.$refs["ruleForm"].resetFields()})},update:function(t,e){var a=this;this.edit=!0,this.loading=!1,this.callback=e,this.show=!0,this.$nextTick(function(){for(var e in a.$refs["ruleForm"].resetFields(),a.form)a.form[e]=t[e];a.form.sid=t.sid})},save:function(){var t=this;this.$refs["ruleForm"].validate(function(e){if(!e)return!1;t.loading=!0;var a=Object.assign({},t.form);1===a.viewType&&5===a.viewType||(a.productAttrValueList=[]),t.callback(a)})},close:function(){this.show=!1},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs["saveTagInput"].$refs.input.focus()})},removeAttr:function(t){this.form.productAttrValueList.splice(t,1)},handleInputConfirm:function(){var t=this.inputValue;t&&this.form.productAttrValueList.push({attrValue:t}),this.inputVisible=!1,this.inputValue=""}}},d=f,h=(a("9a47"),a("2877")),m=Object(h["a"])(d,u,c,!1,null,null,null),v=m.exports,b={name:"PageProductAttribute",components:{searchBar:o["a"],WinAttribute:v},data:function(){return{searchData:{quickList:[{label:"按属性键名",value:"attrName"}],searchList:[{prop:"type",placeholder:"属性类型",type:"select",clearable:!0,list:p["a"].typeData}],page:{size:20,current:1}},searchParams:{},tableData:[],page:{total:0},typeData:p["a"].typeData,viewTypeData:p["a"].viewTypeData}},computed:Object(i["a"])({},Object(s["mapGetters"])(["permissions"]),{height:function(){return this.$store.getters.winHeight-205}}),methods:{query:function(t){var e=this;this.listLoading=!0,Object(l["c"])(Object.assign({},t,this.searchParams)).then(function(t){e.tableData=t.data.data.records,e.page.total=t.data.data.total,e.listLoading=!1})},sizeChange:function(t){this.$refs["refSearch"].search({size:t})},pageChange:function(t){this.$refs["refSearch"].search({current:t})},create:function(){var t=this;this.$refs["refAttribute"].add(function(e){Object(l["a"])(e).then(function(){t.$refs["refAttribute"].loading=!1,t.$refs["refAttribute"].close(),t.query(),t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})}).catch(function(){t.$refs["refAttribute"].loading=!1})})},remove:function(t){var e=this;this.$confirm('是否确认删除名称为"'+t.attrName+'"的属性吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return Object(l["b"])(t)}).then(function(){e.query(),e.$message({showClose:!0,message:"删除成功",type:"success"})}).catch(function(){})},update:function(t){var e=this;this.$refs["refAttribute"].update(t,function(t){Object(l["d"])(t).then(function(){e.query(),e.$refs["refAttribute"].loading=!1,e.$refs["refAttribute"].close(),e.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})}).catch(function(){e.$refs["refAttribute"].loading=!1})})}}},g=b,y=Object(h["a"])(g,r,n,!1,null,null,null);e["default"]=y.exports}}]);
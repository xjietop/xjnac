(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54bcdd55"],{"11f6":function(e,t,a){"use strict";var r=a("24ed"),n=a.n(r);n.a},"24ed":function(e,t,a){},"343c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("search-bar",{ref:"refSearch",attrs:{"search-data":e.searchData,"auto-load":!0},on:{search:e.query}},[a("template",{slot:"right"},[a("div",{staticClass:"app-search-right"},[a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:e.create}},[e._v("添加")])],1)])],2),e._v(" "),a("div",{staticClass:"app-table"},[a("el-table",{attrs:{data:e.tableData,height:e.height}},[a("el-table-column",{attrs:{prop:"username",label:"用户名","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"supplyCn",label:"供应商","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"clubsCn",label:"俱乐部","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deptName",label:"部门","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"role",label:"角色","min-width":"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.roleList,function(t){return a("el-tag",{key:t.roleId,attrs:{effect:"plain"}},[e._v(e._s(t.roleName))])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"lockFlag",label:"状态","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","min-width":"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.update(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.remove(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"app-pagination"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","prev-text":"上一页","next-text":"下一页","page-sizes":[20,50,100,200],"current-page":e.searchData.page.current,"page-size":e.searchData.page.size,total:e.page.total},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1),e._v(" "),a("win-role",{ref:"refUser"}),e._v(" "),a("win-permession",{ref:"refPermession"})],1)},n=[],s=(a("386d"),a("b775")),o=a("700d");function l(e){return Object(s["a"])({baseURL:o["a"],url:"/admin/user/page",method:"get",params:e})}function i(e){return Object(s["a"])({baseURL:o["a"],url:"/admin/user",method:"post",data:e})}function c(e){return Object(s["a"])({baseURL:o["a"],url:"/admin/user/"+e,method:"delete"})}function u(e){return Object(s["a"])({baseURL:o["a"],url:"/admin/user",method:"put",data:e})}function d(e){return Object(s["a"])({baseURL:o["a"],url:"/admin/role/list",method:"get"})}function p(e){return Object(s["a"])({baseURL:o["a"],url:"/admin/dept/tree",method:"get"})}var f=a("b932"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"el-win-auth-user",attrs:{title:e.edit?"编 辑":"新 增",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,size:"medium","label-width":"96px"}},[a("el-form-item",{attrs:{prop:"username",label:"用户名："}},[a("el-input",{attrs:{maxlength:20,placeholder:"请输入用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password",label:"密码："}},[a("el-input",{attrs:{type:"password",maxlength:20,placeholder:"请输入密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"phone",label:"手机号："}},[a("el-input",{attrs:{maxlength:20,placeholder:"请输入角色描述"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"role",label:"分配角色："}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},e._l(e.roleListData,function(e){return a("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{prop:"deptId",label:"所属部门："}},[a("el-tree-select",{ref:"refTreeSelect",attrs:{clearable:!0,data:e.deptTreeData,props:e.defaultProps},on:{change:e.changeDept},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"clubs",label:"俱乐部："}},[a("el-checkbox-group",{model:{value:e.form.clubs,callback:function(t){e.$set(e.form,"clubs",t)},expression:"form.clubs"}},[a("el-checkbox",{attrs:{label:1,name:"clubs"}},[e._v("乐赛仙")]),e._v(" "),a("el-checkbox",{attrs:{label:2,name:"clubs"}},[e._v("佐安堂")]),e._v(" "),a("el-checkbox",{attrs:{label:3,name:"clubs"}},[e._v("初心")])],1)],1),e._v(" "),a("el-form-item",{attrs:{prop:"clubs",label:"所属供应商"}},[a("el-select",{attrs:{multiple:""},model:{value:e.form.supplys,callback:function(t){e.$set(e.form,"supplys",t)},expression:"form.supplys"}},e._l(e.supplierData,function(e){return a("el-option",{key:e.sid,attrs:{label:e.name,value:e.sid}})}),1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.show=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("确 定")])],1)],1)},h=[],b=(a("ac6a"),a("e35b")),g=a("df28"),v={name:"WinUser",components:{elTreeSelect:g["a"]},data:function(){return{edit:!1,loading:!1,form:{username:"",deptId:"",role:[],phone:"",password:"",lockFlag:0,clubs:[],supplys:[]},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],deptId:[{required:!0,message:"请输入选择部门",trigger:"change"}]},defaultProps:{label:"name",value:"id"},deptTreeData:[],roleListData:[],supplierData:[],checkedDsScope:[],show:!1}},watch:{},created:function(){},methods:{add:function(e){var t=this;this.edit=!1,this.loading=!1,this.callback=e,this.checkedDsScope=[],this.querySupplierList(function(){t.handleOpenBefore(function(){t.show=!0,t.$nextTick(function(){t.$refs["refTreeSelect"].clearHandle(),t.form.clubs=[],t.form.supplys=[],t.$refs["ruleForm"].resetFields()})})})},update:function(e,t){var a=this;this.edit=!0,this.loading=!1,this.callback=t,this.checkedDsScope=[],this.querySupplierList(function(){a.handleOpenBefore(function(){a.show=!0,a.$nextTick(function(){for(var t in a.$refs["ruleForm"].resetFields(),a.$refs["refTreeSelect"].clearHandle(),a.form)a.form[t]=e[t];a.form.role=[],a.form.clubs=e.clubSet||[],a.form.supplys=e.supplySet||[],a.form.password="",e.roleList.forEach(function(e){a.form.role.push(e.roleId)}),a.form.userId=e.userId})})})},save:function(){var e=this;this.$refs["ruleForm"].validate(function(t){if(!t)return!1;e.loading=!0;var a=Object.assign({},e.form);a.password.length<=0&&delete a.password,1===e.form.dsType&&(a.dsScope=e.$refs.scopeTree.getCheckedKeys().join(",")),e.callback(a)})},close:function(){this.show=!1},handleOpenBefore:function(e){var t=this;p().then(function(a){t.deptTreeData=a.data.data,d().then(function(a){t.roleListData=a.data.data,e()})})},changeDept:function(e){this.form.deptId=e},querySupplierList:function(e){var t=this;Object(b["g"])({size:9999,current:1}).then(function(a){var r=a.data.data;t.supplierData=r.records||[],e()}).catch(function(){})}}},y=v,w=(a("11f6"),a("2877")),_=Object(w["a"])(y,m,h,!1,null,null,null),k=_.exports,x={name:"PageAuthUser",components:{WinRole:k,searchBar:f["a"]},data:function(){return{searchData:{quickList:[{label:"按用户名",value:"username"},{label:"按手机号",value:"phone"}],searchList:[],page:{size:20,current:1}},tableData:[],page:{total:0}}},computed:{height:function(){return this.$store.getters.winHeight-205}},methods:{query:function(e){var t=this;this.listLoading=!0,l(Object.assign({},e)).then(function(e){t.tableData=e.data.data.records,t.page.total=e.data.data.total,t.listLoading=!1})},sizeChange:function(e){this.$refs["refSearch"].search({size:e})},pageChange:function(e){this.$refs["refSearch"].search({current:e})},create:function(){var e=this;this.$refs["refUser"].add(function(t){i(t).then(function(){e.$refs["refUser"].loading=!1,e.$refs["refUser"].close(),e.$refs["refSearch"].search(),e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})}).catch(function(){e.$refs["refUser"].loading=!1})})},remove:function(e){var t=this;this.$confirm('是否确认删除名称为"'+e.username+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return c(e.userId)}).then(function(){t.$refs["refSearch"].search(),t.$message({showClose:!0,message:"删除成功",type:"success"})}).catch(function(){})},update:function(e){var t=this;this.$refs["refUser"].update(e,function(e){u(e).then(function(){t.$refs["refSearch"].search(),t.$refs["refUser"].loading=!1,t.$refs["refUser"].close(),t.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})}).catch(function(){t.$refs["refUser"].loading=!1})})}}},$=x,L=Object(w["a"])($,r,n,!1,null,null,null);t["default"]=L.exports},"386d":function(e,t,a){"use strict";var r=a("cb7c"),n=a("83a1"),s=a("5f1b");a("214f")("search",1,function(e,t,a,o){return[function(a){var r=e(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,r):new RegExp(a)[t](String(r))},function(e){var t=o(a,e,this);if(t.done)return t.value;var l=r(e),i=String(this),c=l.lastIndex;n(c,0)||(l.lastIndex=0);var u=s(l,i);return n(l.lastIndex,c)||(l.lastIndex=c),null===u?-1:u.index}]})},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},e35b:function(e,t,a){"use strict";a.d(t,"f",function(){return s}),a.d(t,"g",function(){return o}),a.d(t,"b",function(){return l}),a.d(t,"d",function(){return i}),a.d(t,"h",function(){return c}),a.d(t,"c",function(){return u}),a.d(t,"a",function(){return d}),a.d(t,"i",function(){return p}),a.d(t,"e",function(){return f});var r=a("b775"),n=a("700d");function s(e){return Object(r["a"])({baseURL:n["a"],url:"/member/admin/supply",method:"post",headers:{"Content-Type":"application/json"},data:e})}function o(e){return Object(r["a"])({baseURL:n["a"],url:"/member/admin/supply",method:"get",params:e})}function l(e){return Object(r["a"])({baseURL:n["a"],url:"/member/admin/supply/".concat(e.sid),method:"delete"})}function i(e){return Object(r["a"])({baseURL:n["a"],url:"/member/admin/supply/erpCode?sid=".concat(e.sid,"&erpCode=").concat(e.erpCode),method:"put"})}function c(e){return Object(r["a"])({baseURL:n["a"],url:"/member/admin/supply/supplyStatus/".concat(e.sid,"/").concat(e.status),method:"put"})}function u(e){return Object(r["a"])({baseURL:n["a"],url:"/member/admin/supply/edit",method:"put",data:e})}function d(e){return Object(r["a"])({baseURL:n["a"],url:"/member/admin/supply/areaList/".concat(e),method:"get"})}function p(){return Object(r["a"])({baseURL:n["a"],url:"/admin/external/area/treeInfo",method:"get"})}function f(e){return Object(r["a"])({baseURL:n["a"],url:"/member/admin/supply/areaSids/".concat(e.sid),method:"put",headers:{"Content-Type":"application/json"},data:{areaSids:e.sidList}})}}}]);